<div class="row">
  <content class="col-md-9" role="main">
    <div class="page-header">
      <h1>Alerts</h1>
    </div>

    <% if @alerts.size == 0 %>

      <div class="alert alert-info" role="alert">
        <button type="button" class="close" data-dismiss="alert">
          <span aria-hidden="true">&times;</span>
          <span class="sr-only">Close</span>
        </button>
        No alerts found! <strong>:-)</strong>
        <% unless params[:days] == 'all' %>
          <a href="/alerts?days=all" class="alert-link">Show all alerts.</a>
        <% end %>
      </div>

    <% else %>
      <table class="table table-striped">
        <thead>
          <tr>
            <th>Name</th>
            <th>Alert-Count</th>
            <th>Created At</th>
            <th class="text-right">Actions</th>
          </tr>
        </thead>
        <tbody>
      <% @alerts.each do |alert| %>
          <tr <%= 'class="success"' if alert.acknowledged_at %>>
            <td>
              <b>
                <a href="/alerts/<%= alert.id %>"><%= alert.name %></a>
              </b>
            </td>
            <td>
              <span class="badge"><%= alert.count %></span>
            </td>
            <td><%= h_time(alert.created_at) %></td>
            <td class="text-right">
              <% if alert.acknowledged_at -%>
                <a href="/alerts/<%= alert.id %>/delete" class="btn btn-sm btn-danger">Delete</a>
              <% else -%>
                <form action="/alerts/<%= alert.id %>/acknowledge?uid=<%= alert.uid %>" method="post" style="display: inline-block">
                  <button type="submit" class="btn btn-sm btn-success">Acknowledge</button>
                </form>
              <% end -%>
              <a href="/alerts/<%= alert.id %>" class="btn btn-sm btn-primary">Show</a>
            </td>
          </tr>
      <% end %>
        </tbody>
      </table>
      <%= paginate @alerts, 'alerts' %>
    <% end %>

    <p>
      <a type="button" class="btn btn-success" href="/alerts/new">
        New Alert
      </a>
    </p>
  </content>

  <sidebar class="col-md-3">
    <div class="page-header">
      <h3>Filters</h3>
    </div>
    <menu class="hidden-print" role="complementary">
      <h4>Time Filter</h4>
      <ul class="nav nav-pills nav-stacked">
        <li <% if params[:days] == 'all' %>class="active"<% end %>>
          <a href="/alerts?<%= merge_query_string(days: "all") %>">All</a>
        </li>
        <li <% if params[:days] == '7' || params[:days] == nil %>class="active"<% end %>>
          <a href="/alerts?<%= merge_query_string(days: "7") %>">Last week</a>
        </li>
        <li <% if params[:days] == '30' %>class="active"<% end %>>
          <a href="/alerts?<%= merge_query_string(days: "30") %>">Last 4 weeks</a>
        </li>
      </ul>
      <h4>Acknowledged Filter</h4>
      <ul class="nav nav-pills nav-stacked">
        <li <% if params[:ack] == 'all' || params[:ack] == nil  %>class="active"<% end %>>
          <a href="/alerts?<%= merge_query_string(ack: "all") %>">All</a>
        </li>
        <li <% if params[:ack] == 'false' %>class="active"<% end %>>
          <a href="/alerts?<%= merge_query_string(ack: "false") %>">Unacknowledged</a>
        </li>
        <li <% if params[:ack] == 'true' %>class="active"<% end %>>
          <a href="/alerts?<%= merge_query_string(ack: "true") %>">Acknowledged</a>
        </li>
      </ul>
    </menu>
  </sidebar>
</div>
